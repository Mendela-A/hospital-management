# üê≥ –ó–∞–ø—É—Å–∫ –ø—Ä–æ—î–∫—Ç—É –≤ Docker –∑ HTTPS

## üìã –ü–µ—Ä–µ–¥—É–º–æ–≤–∏

–í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –Ω–∞ –≤–∞—à—ñ–π —Å–∏—Å—Ç–µ–º—ñ:
- Docker (–≤–µ—Ä—Å—ñ—è 20.10+)
- Docker Compose (–≤–µ—Ä—Å—ñ—è 2.0+)
- OpenSSL (–¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—ñ–≤)

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### –ö—Ä–æ–∫ 1: –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ—î–∫—Ç—É

```bash
# –ü–µ—Ä–µ–π–¥—ñ—Ç—å –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é –ø—Ä–æ—î–∫—Ç—É
cd health_patients_3

# –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó
mkdir -p nginx logs
```

### –ö—Ä–æ–∫ 2: –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è SSL —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∞

```bash
# –ó—Ä–æ–±—ñ—Ç—å —Å–∫—Ä–∏–ø—Ç –≤–∏–∫–æ–Ω—É–≤–∞–Ω–∏–º
chmod +x generate-ssl.sh

# –ó–∞–ø—É—Å—Ç—ñ—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü—ñ—é —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∞
./generate-ssl.sh
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π —Å–ø–æ—Å—ñ–± (–≤—Ä—É—á–Ω—É):**

```bash
mkdir -p nginx/ssl

openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
    -keyout nginx/ssl/key.pem \
    -out nginx/ssl/cert.pem \
    -subj "/C=UA/ST=Ivano-Frankivsk/L=Perehinske/O=Hospital/OU=IT/CN=localhost"
```

### –ö—Ä–æ–∫ 3: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó Nginx

```bash
# –°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª nginx/nginx.conf
# –°–∫–æ–ø—ñ—é–π—Ç–µ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é –∑ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—É nginx-config
```

### –ö—Ä–æ–∫ 4: –û–Ω–æ–≤–ª–µ–Ω–Ω—è .env —Ñ–∞–π–ª—É (–æ–ø—Ü—ñ–π–Ω–æ)

–°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `.env` –¥–ª—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó:

```env
SECRET_KEY=your-super-secret-production-key-here
FLASK_ENV=production
DATABASE_URL=sqlite:///hospital.db
```

### –ö—Ä–æ–∫ 5: –ó–±—ñ—Ä–∫–∞ —Ç–∞ –∑–∞–ø—É—Å–∫

```bash
# –ó—ñ–±—Ä–∞—Ç–∏ Docker –æ–±—Ä–∞–∑–∏
docker-compose build

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏
docker-compose up -d

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å
docker-compose ps
```

### –ö—Ä–æ–∫ 6: –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

```bash
# –í–∏–∫–æ–Ω–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—é –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ
docker-compose exec web python migrate_db.py

# –ê–ë–û —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤—É –±–∞–∑—É –¥–∞–Ω–∏—Ö
docker-compose exec web python -c "from app import create_app, db; app = create_app(); app.app_context().push(); db.create_all(); print('DB created')"
```

## üåê –î–æ—Å—Ç—É–ø –¥–æ –¥–æ–¥–∞—Ç–∫—É

- **HTTP:** http://localhost (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å—É—î—Ç—å—Å—è –Ω–∞ HTTPS)
- **HTTPS:** https://localhost

### ‚ö†Ô∏è –ü–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞

–û—Å–∫—ñ–ª—å–∫–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç —Å–∞–º–æ–ø—ñ–¥–ø–∏—Å–Ω–∏–π, –±—Ä–∞—É–∑–µ—Ä –ø–æ–∫–∞–∂–µ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è:
1. Chrome: "–í–∞—à–µ –∑'—î–¥–Ω–∞–Ω–Ω—è –Ω–µ –∑–∞—Ö–∏—â–µ–Ω–µ" ‚Üí –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–î–æ–¥–∞—Ç–∫–æ–≤–æ" ‚Üí "–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ localhost"
2. Firefox: "–ü–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è: –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∞ –∑–∞–≥—Ä–æ–∑–∞ –±–µ–∑–ø–µ—Ü—ñ" ‚Üí "–î–æ–¥–∞—Ç–∫–æ–≤–æ" ‚Üí "–ü—Ä–∏–π–Ω—è—Ç–∏ —Ä–∏–∑–∏–∫ —ñ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏"
3. Edge: "–í–∞—à–µ –∑'—î–¥–Ω–∞–Ω–Ω—è –Ω–µ —î –ø—Ä–∏–≤–∞—Ç–Ω–∏–º" ‚Üí "–î–æ–¥–∞—Ç–∫–æ–≤–æ" ‚Üí "–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ localhost"

## üìä –ö–æ—Ä–∏—Å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏

### –ü–µ—Ä–µ–≥–ª—è–¥ –ª–æ–≥—ñ–≤

```bash
# –í—Å—ñ –ª–æ–≥–∏
docker-compose logs -f

# –¢—ñ–ª—å–∫–∏ Flask –¥–æ–¥–∞—Ç–æ–∫
docker-compose logs -f web

# –¢—ñ–ª—å–∫–∏ Nginx
docker-compose logs -f nginx
```

### –ó—É–ø–∏–Ω–∫–∞ —Ç–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è

```bash
# –ó—É–ø–∏–Ω–∏—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏
docker-compose stop

# –ó—É–ø–∏–Ω–∏—Ç–∏ —ñ –≤–∏–¥–∞–ª–∏—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏
docker-compose down

# –í–∏–¥–∞–ª–∏—Ç–∏ –≤—Å–µ –≤–∫–ª—é—á–Ω–æ –∑ volumes
docker-compose down -v
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—ñ—Å–ª—è –∑–º—ñ–Ω

```bash
# –ü–µ—Ä–µ–∑–±—É–¥—É–≤–∞—Ç–∏ —Ç–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏
docker-compose up -d --build

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç—ñ–ª—å–∫–∏ –æ–¥–∏–Ω —Å–µ—Ä–≤—ñ—Å
docker-compose restart web
```

### –î–æ—Å—Ç—É–ø –¥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
# Bash –≤ Flask –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ
docker-compose exec web bash

# –í—ñ–¥–∫—Ä–∏—Ç–∏ Python shell –∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –¥–æ–¥–∞—Ç–∫—É
docker-compose exec web python
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
health_patients_3/
‚îú‚îÄ‚îÄ app/                    # –ö–æ–¥ –¥–æ–¥–∞—Ç–∫—É
‚îú‚îÄ‚îÄ nginx/
‚îÇ   ‚îú‚îÄ‚îÄ nginx.conf         # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Nginx
‚îÇ   ‚îî‚îÄ‚îÄ ssl/
‚îÇ       ‚îú‚îÄ‚îÄ cert.pem       # SSL —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç
‚îÇ       ‚îî‚îÄ‚îÄ key.pem        # –ü—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á
‚îú‚îÄ‚îÄ logs/                  # –õ–æ–≥–∏ –¥–æ–¥–∞—Ç–∫—É
‚îú‚îÄ‚îÄ hospital.db           # –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö (—Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ)
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ generate-ssl.sh
‚îî‚îÄ‚îÄ requirements.txt
```

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è Production

### 1. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è PostgreSQL –∑–∞–º—ñ—Å—Ç—å SQLite

–î–æ–¥–∞–π—Ç–µ –¥–æ `docker-compose.yml`:

```yaml
services:
  db:
    image: postgres:15-alpine
    environment:
      POSTGRES_DB: hospital
      POSTGRES_USER: hospital_user
      POSTGRES_PASSWORD: strong_password
    volumes:
      - postgres_data:/var/lib/postgresql/data
    networks:
      - hospital_network

  web:
    environment:
      - DATABASE_URL=postgresql://hospital_user:strong_password@db:5432/hospital
    depends_on:
      - db

volumes:
  postgres_data:
```

### 2. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Let's Encrypt –¥–ª—è —Å–ø—Ä–∞–≤–∂–Ω—ñ—Ö —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—ñ–≤

```bash
# –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å certbot
sudo apt install certbot python3-certbot-nginx

# –û—Ç—Ä–∏–º–∞–π—Ç–µ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç
sudo certbot --nginx -d your-domain.com
```

### 3. –ó–º—ñ–Ω–∞ SECRET_KEY

```bash
# –ó–≥–µ–Ω–µ—Ä—É–π—Ç–µ –±–µ–∑–ø–µ—á–Ω–∏–π –∫–ª—é—á
python -c "import secrets; print(secrets.token_hex(32))"

# –î–æ–¥–∞–π—Ç–µ –≤ .env –∞–±–æ docker-compose.yml
SECRET_KEY=<–≤–∞—à_–∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π_–∫–ª—é—á>
```

## üêõ –í–∏—Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º

### –ü–æ—Ä—Ç –≤–∂–µ –∑–∞–π–Ω—è—Ç–∏–π

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —è–∫–∏–π –ø—Ä–æ—Ü–µ—Å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø–æ—Ä—Ç
sudo lsof -i :80
sudo lsof -i :443

# –ó—É–ø–∏–Ω—ñ—Ç—å –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—É—é—á–∏–π —Å–µ—Ä–≤—ñ—Å –∞–±–æ –∑–º—ñ–Ω—ñ—Ç—å –ø–æ—Ä—Ç–∏ –≤ docker-compose.yml
ports:
  - "8080:80"
  - "8443:443"
```

### –ü–æ–º–∏–ª–∫–∏ –∑ –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø—É –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

```bash
# –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –ø—Ä–∞–≤–∞
chmod 666 hospital.db
```

### –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏
docker-compose logs web

# –ü–µ—Ä–µ–∑–±—É–¥—É–π—Ç–µ –±–µ–∑ –∫–µ—à—É
docker-compose build --no-cache
```

## üìö –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ä–µ—Å—É—Ä—Å–∏

- [Docker Documentation](https://docs.docker.com/)
- [Nginx Documentation](https://nginx.org/en/docs/)
- [Flask Deployment](https://flask.palletsprojects.com/en/latest/deploying/)

## üîí –ë–µ–∑–ø–µ–∫–∞

**–î–ª—è –≤–∏—Ä–æ–±–Ω–∏—á–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞:**
- ‚úÖ –ó–º—ñ–Ω—ñ—Ç—å SECRET_KEY
- ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Å–ø—Ä–∞–≤–∂–Ω—ñ SSL —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏
- ‚úÖ –ù–∞–ª–∞—à—Ç—É–π—Ç–µ firewall
- ‚úÖ –û–±–º–µ–∂—Ç–µ –¥–æ—Å—Ç—É–ø –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–Ω–æ–≤–ª—é–π—Ç–µ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
- ‚úÖ –ù–∞–ª–∞—à—Ç—É–π—Ç–µ backup –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

---

**–ê–≤—Ç–æ—Ä:** –°–∏—Å—Ç–µ–º–∞ –æ–±–ª—ñ–∫—É –ø–∞—Ü—ñ—î–Ω—Ç—ñ–≤  
**–í–µ—Ä—Å—ñ—è:** 1.0  
**–î–∞—Ç–∞:** –ì—Ä—É–¥–µ–Ω—å 2024